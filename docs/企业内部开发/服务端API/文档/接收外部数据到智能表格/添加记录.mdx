---
title: "添加记录"
generated_at: "2026-02-09 03:26:39"
update_time: 1769430407
source: "https://developer.work.weixin.qq.com/document/path/101240"
---

[TOC]
## 添加记录
可以通过工作表 Webhook 地址向智能表格的工作表添加一行或多行新记录。单表最多允许有100000行记录，15000000个单元格。
**注意**
暂不支持通过Webhook给公式、自动编号、查找引用、关联、创建人、创建时间、最后编辑人、最后编辑时间、群聊、文件字段添加记录。

**请求方式**：POST(HTTPS)
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/wedoc/smartsheet/webhook?key=KEY

> 开启「接收外部数据」获取到的工作表Webhook地址即为请求地址，启用入口详见[配置说明](#60593/数据写入配置说明)
> 请求包体写法请参考对应工作表提供的「示例数据」，示例数据位置详见[配置说明](#60593/数据写入配置说明)


**请求包体**：
```json
{
	"add_records": [{
		"values": {
			"FIELD_ID": [{
				"type": "text",
				"text": "文本内容"
			}]
		}
	}]
}
```

**参数说明**
|参数 |类型 |是否必须 |说明 |
|:--|
|add_records|Object\[\]([AddRecord](#addrecord))|是|需要添加的记录的具体内容组成的 JSON 数组|

**返回示例**

```json
{
    "errcode": 0,
    "errmsg": "ok",
    "add_records": [
			
    ]
}
```
**参数说明**
| 参数|类型| 说明|
|:--|
| errcode |int32| 错误码|
| errmsg  |string| 错误码说明 |
|add_records|Object\[\]([CommonRecord](#commonrecord))|由添加成功的记录的具体内容组成的 JSON 数组|

## 参数详细说明


### AddRecord
添加记录：
|参数名 |类型 |描述 |
|:--|
|values | Object |记录的具体内容，key 为字段标题或字段 ID ，value 详见([Value](#value)) |

### CommonRecord
在智能表格的某个工作表中添加记录响应、更新记录请求和更新记录响应的通用参数：
|参数名 |类型 |描述 |
|:--|
|record_id |string |记录 ID |
|values | Object |记录的具体内容，key 为字段标题或字段 ID ，value 详见([Value](#value)) |


### Value
各种类型的字段对应的单元格的值
|字段类型|单元格值类型|描述|
|:--|
|文本(FIELD_TYPE_TEXT)|string \| Object\[\]([CellTextValue](#celltextvalue))|文本单元格内容。</br>**简单模式**：传入字符串，如  `"Hello"`</br>  **完整模式**：传入对象数组，如  `[{"type":"text","text":"Hello"}]`</br>请求时支持两种模式写入，返回时默认为完整模式|
|数字(FIELD_TYPE_NUMBER)|double|
|复选框(FIELD_TYPE_CHECKBOX)|bool|
|日期(FIELD_TYPE_DATE_TIME)|string(以毫秒为单位的unix时间戳)|
|图片(FIELD_TYPE_IMAGE)|Object\[\]([CellImageValue](#cellimagevalue))|
|成员(FIELD_TYPE_USER)|Object\[\]([CellUserValue](#celluservalue))|
|链接(FIELD_TYPE_URL)|Object\[\]([CellUrlValue](#cellurlvalue))|数组类型为预留能力，目前只支持展示一个链接，建议只传入一个链接|
|多选(FIELD_TYPE_SELECT)|Object\[\]([Option](#option))|
|进度(FIELD_TYPE_PROGRESS)|double|
|电话(FIELD_TYPE_PHONE_NUMBER)|string|
|邮箱(FIELD_TYPE_EMAIL)|string|
|单选(FIELD_TYPE_SINGLE_SELECT)|Object\[\]([Option](#option))|
|地理位置(FIELD_TYPE_LOCATION)|Object\[\]([CellLocationValue](#celllocationvalue))| 长度不大于1的数组。|
|货币(FIELD_TYPE_CURRENCY)|double| |
|百分数(FIELD_TYPE_PERCENTAGE)|double| |
|条码(FIELD_TYPE_BARCODE)|string|


### CellTextValue
文本类型字段的单元值类型
|参数名 |类型 |描述 |
|:--|
|type|string|内容为文本(值为`text`)、内容为链接(值为`url`)|
|text|string|单元格内容|
|link|string|当type时`url`时，表示链接跳转url|

### CellImageValue
|参数名 |类型 |描述 |
|:--|
|title |string |图片标题 |
|image_base64 |string |图片内容的base64编码  |


### CellUserValue
|参数名 |类型 |描述 |
|:--|
|user_id | string | 成员ID |

> 开发者可通过「[获取成员ID列表](#40856)」接口获取成员 userid。

### CellUrlValue
数组类型为预留能力，目前只支持展示一个链接，建议只传入一个链接
**示例**
```json
{
	"link": "https://developer.work.weixin.qq.com/document/path/97392",
	"text": "企业微信开发者中心"
}
```
|参数名 |类型 |描述 |
|:--|
|text|string|链接显示文本|
|link|string|链接跳转url|


### Option
**示例**
```json
{
	"text": "1"
}
```
|参数名 |类型 |描述 |
|:--|
|style | int([Style](#53117/style)) | 选项颜色。新增选项时填写 |
|text | string |要填写的选项内容。新增选项时填写，已经存在时优先匹配已经存在的选项，否则会新增选项  |

### CellLocationValue
**示例**
```json
{
	"id": "14313005936863363130",
	"latitude": "23.10647",
	"longitude": "113.32446",
	"source_type": 1,
	"title": "广州塔"
}
```
|参数名 |类型 |描述 |
|:--|
|source_type | uint32 | 填`1`，表示来源为`腾讯地图`。目前只支持腾讯地图来源 |
|id | string | 地点ID |
|latitude | string | 纬度 |
|longitude | string | 经度 |
|title | string | 地点名称 |
